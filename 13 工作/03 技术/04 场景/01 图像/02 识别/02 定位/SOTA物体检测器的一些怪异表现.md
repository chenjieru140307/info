
# SOTA物体检测器的一些怪异表现

物体检测器是有一些缺陷的。


## 1、准备

作者用tensorflow的物体检测API，使用faster rcnn nas模型，该模型是MS-COCO上当前表现最好的模型；

从MS-COCO当中挑了两张图片；

然后将一张图片的物体粘贴到另一张图片上；

然后开始调用物体检测API检测上述生成的图片。

![img](https://pic4.zhimg.com/80/v2-f3ef28ea4356375d913a3c6429adae57_hd.jpg)准备

## 2、房间里的大象

原图如图1所示。

![img](https://pic2.zhimg.com/80/v2-b90684809d21c92220c706bfb838cde1_hd.jpg)图1

在图1上面粘贴一张大象图片得到图1-2，可以看到原本可以检测出来的杯子现在检测不出来了，大象也检测不出来。

![img](https://pic1.zhimg.com/80/v2-a6f88a61f9b8a844676d1f72a09c29b4_hd.jpg)图1-1

将图1-1的大象右移几个像素点，得到图1-2，大象能检测出来了，杯子依然检测不出来。

![img](https://pic2.zhimg.com/80/v2-4a401561b73502b9c5a7ecd3063b7101_hd.jpg)图1-2

将图1-2中的大象右移，得到图1-3，大象检测不出来了，但是杯子却被检测出来了。

![img](https://pic1.zhimg.com/80/v2-221cc915df4cc889135b5fa3776a4300_hd.jpg)图1-3

将图1-3中的大象右移，得到图1-4，终于大象和杯子都能被检测出来了。

![img](https://pic2.zhimg.com/80/v2-8e2c127d7ec0718345e69f2af2776c69_hd.jpg)图1-4

将图1-4中的大象右移，得到图1-5，这次大象被识别为椅子。

![img](https://pic3.zhimg.com/80/v2-447314e0875006266fa1f38a8c6b87ce_hd.jpg)图1-5

## 3、飞翔的烤面包机

原图如图2所示。

![img](https://pic2.zhimg.com/80/v2-d979609d34836a99575b1ce33f4485a9_hd.jpg)图2

在图2基础上粘贴上一个烤面包机得到图2-1，烤面包机被识别为冰箱。

![img](https://pic3.zhimg.com/80/v2-807832dce569d0e82a5c27741998beb6_hd.jpg)图2-1

将图2中的烤面包机右移，得到图2-1，烤面包机既被识别为冰箱也被识别为烤面包机。

![img](https://pic3.zhimg.com/80/v2-88541d439a5471fa3530f7ad284b58a2_hd.jpg)图2-2

将图2-1中的烤面包机右移，得到图2-2，烤面包机终于被识别为烤面包机。

![img](https://pic4.zhimg.com/80/v2-e056484731e5121c5c689e10e1e4f1e7_hd.jpg)图2-3

## 4、思考

上述两个例子只是视频中的一部分。这个视频让我们直观地感受到了当前SOTA物体检测器的问题，这些问题从普通人的角度来看，觉得非常怪异，非常不可思议，甚至觉得当前SOTA物体检测器太笨了。

但是从从业者的角度来看，这些问题在意料之中。

首先检测器的感受野比较大，也就是检测器最后一层feature map的特征所能看到原图的部分很大，通常远远大于所要检测的物体，检测器检测根据目标物体以及它**周围的context**来判断此处有什么物体，也就是说context对检测器的影响比较大。当我们把一个物体粘贴到另外一张图像上面的时候，这个物体周围的context和该物体是不太搭的，例如一般情况大象不可能在房间里，烤面包机野不太可能出现在大马路上。

其次，待检测物体的**scale**对检测效果影响也较大，像图2中的烤面包机，那么大，训练集里基本不会出现这么大的烤面包机，训练集出现得少会让检测器对该scale的物体训练不充分，预测的时候表现不好也情有可原。

再次，物体的所在的位置对检测效果也有影响，因为检测器的CNN部分**不是translation equivariance**的，具体可以参见[这篇文章](https://link.zhihu.com/?target=https%3A//arxiv.org/pdf/1805.12177.pdf)，你把一个物体在图片上移动的时候，对应的feature map并没有相应平移。

总结来看，对于一个深度学习/机器学习模型来说，训练集和测试集的数据分布应该一致，不然模型表现不好是意料之中，训练集就如同我们平时学习的知识点，测试集如同考试的知识点。考试的知识点超纲了，作为人类都只能抓瞎，更何况机器呢。

训练集和测试集的数据分布一致体现在很多方面，比如物体的scale一致，物体所处场景一致等等。


# 相关

- [SOTA物体检测器的一些怪异表现](https://zhuanlan.zhihu.com/p/39780397?utm_source=ZHShareTargetIDMore&utm_medium=social&utm_oi=56829493116928)
