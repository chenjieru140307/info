---
title: CTR 预估
toc: true
date: 2019-09-29
---
# CTR预估

CTR预估作为一个偏应用的技术方向，对于互联网公司而言应该是最重要也最关注的方向之一。道理很简单，目前大型互联网公司绝大多数利润都来源于此，因为这是计算广告方向最主要的技术手段。

从计算广告的角度讲，所谓 CTR 预估就是对于给定的用户 User，在特定的上下文 Context 下，如果展示给这个用户某个广告或者产品 Product，估算用户是否会点击这个广告或者是否会购买某个产品，即求点击概率。

可以看到，这是个适用范围很广的技术，很多推荐场景以及包括目前比较火的信息流排序等场景都可以转换为 CTR 预估问题。

## 使用深度学习进行 CTR 预估

CTR预估常用的技术手段包括演进路线一般是按照:

“LR->GBDT等树模型->FM因子分解机模型->深度学习”

这个路径来发展的。深度学习在图像视频、语音、自然语言处理等领域最近几年获得了飞速的进展，但是最近一两年学术界才开始比较频繁地陆续出现深度学习如何和 CTR 预估相结合的文章。Google最早在几年前就开始研究这方面的内容，之后国内的大型互联网公司也开始跟进。

CTR预估场景有自己独特的应用特点，而想要用深度学习解决 CTR 预估问题，必须考虑如何融入和体现这些特点。我们知道，DNN模型便于处理连续数值型特征，而图像语音等天然满足这一条件，但是 CTR 预估场景会包含大量的离散特征，比如一个人的性别、毕业学校等都属于离散特征。


所以用深度学习做 CTR 预估首先要解决的问题是如何表征离散特征，一种常见的方法是把离散特征转换为 Onehot 表示，但是在大型互联网公司应用场景下，特征维度都是百亿以上级别的，如果采用 Onehot 表征方式，意味着网络模型会包含太多参数需要学习。所以**目前主流的深度学习解决方案都采用将 Onehot 特征表示转换为低维度实数向量（Dense Vector，类似于 NLP 中的 Word Embedding）的思路**，这样可以大量降低参数规模。

另外一个 CTR 关注的重心是如何进行自动特征组合的问题，因为好的特征组合对于性能影响非常关键，而深度学习天然具有端对端的优势，所以这是神经网络模型能够自然发挥作用的地方，能够**无需人工介入自动找到好的特征组合**，这一般体现在深度 CTR 模型的 Deep 网络部分。

## CTR 模型结构

除了更早一些的流传甚广的 Wide &Deep模型，最近一年出现了一些新的深度 CTR 模型，比如 DeepFM、DeepCross、NFM模型等。

这些模型其实如果仔细进行分析，会发现它们在网络结构上存在极大的相似性。除了在网络结构上体现上述的两个特点：

- 一个是 Dense Vector表示离散特征
- 另外一个是利用 Deep 网络对特征组合进行自动建模。

另外一个主流的特点是：

- 将低维特征组合和高维特征组合在网络结构上进行分离，Deep网络体现高维度特征组合，而引入神经网络版本的 FM 模型来对两两特征组合进行建模。

这三个网络结构特点基本囊括了目前所有深度 CTR 模型。

下面两张图是两种常见的深度 CTR 网络结构，目前所有模型基本都采用了其中之一种结构。

<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190927/Vtzkyqse3Urv.png?imageslim">
</p>

> 并行深度 CTR 网络结构


<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190927/UezIbnUSQWXO.png?imageslim">
</p>

> 串行深度 CTR 网络结构
