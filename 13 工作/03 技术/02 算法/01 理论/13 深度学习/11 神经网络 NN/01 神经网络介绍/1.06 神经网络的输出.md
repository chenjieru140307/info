

### 3.2.2 如何计算神经网络的输出？

<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190722/6nKj2eWXtdhj.png?imageslim">
</p>


如上图，输入层有三个节点，我们将其依次编号为 1、2、3；隐藏层的 4 个节点，编号依次为 4、5、6、7；最后输出层的两个节点编号为 8、9。比如，隐藏层的节点 4，它和输入层的三个节点 1、2、3 之间都有连接，其连接上的权重分别为是 $w_{41}, w_{42}, w_{43}$。

为了计算节点 4 的输出值，我们必须先得到其所有上游节点（也就是节点 1、2、3）的输出值。节点 1、2、3 是输入层的节点，所以，他们的输出值就是输入向量本身。按照上图画出的对应关系，可以看到节点 1、2、3 的输出值分别是 $x_1, x_2, x_3$。

$$
a_4 = \sigma(w^T \cdot a) = \sigma(w_{41}x_4 + w_{42}x_2 + w_{43}a_3 + w_{4b})
$$

其中 $w_{4b}$ 是节点 4 的偏置项。

同样，我们可以继续计算出节点 5、6、7 的输出值 $a_5, a_6, a_7$。

计算输出层的节点 8 的输出值 $y_1​$：

$$
y_1 = \sigma(w^T \cdot a) = \sigma(w_{84}a_4 + w_{85}a_5 + w_{86}a_6 + w_{87}a_7 + w_{8b})
$$

其中 $w_{8b}​$ 是节点 8 的偏置项。

同理，我们还可以计算出 $y_2$。这样输出层所有节点的输出值计算完毕，我们就得到了在输入向量 $x_1, x_2, x_3, x_4$ 时，神经网络的输出向量 $y_1, y_2$ 。这里我们也看到，输出向量的维度和输出层神经元个数相同。
