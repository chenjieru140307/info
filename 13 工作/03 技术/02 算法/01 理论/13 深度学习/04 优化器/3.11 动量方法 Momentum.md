---
title: 3.11 动量方法 Momentum
toc: true
date: 2019-09-03
---

### 动量（Momentum）方法

为了解决随机梯度下降法山谷震荡和鞍点停滞的问题，我们做一个简单的思维实验。想象一下纸团在山谷和鞍点处的运动轨迹，在山谷中纸团受重力作用沿山道滚下，两边是不规则的山壁，纸团不可避免地撞在山壁，由于质量小受山壁弹力的干扰大，从一侧山壁反弹回来撞向另一侧山壁，结果来回震荡地滚下；如果当纸团来到鞍点的一片平坦之地时，还是由于质量小，速度很快减为零。纸团的情况和随机梯度下降法遇到的问题简直如出一辙。

直观地，如果换成一个铁球，当沿山谷滚下时，不容易受到途中旁力的干扰，轨迹会更稳更直；当来到鞍点中心处，在惯性作用下继续前行，从而有机会冲出这片平坦的陷阱。<span style="color:red;">是呀。</span>

因此，有了动量方法，模型参数的迭代公式为：

$$
v_{t}=\gamma v_{t-1}+\eta g_{t}\tag{7.49}
$$

$$
\theta_{t+1}=\theta_{t}-v_{t}\tag{7.50}
$$

具体来说，前进步伐 $−v_t$ 由两部分组成。

- 一是学习速率 $\eta$ 乘以当前估计的梯度 $g_t$；
- 二是带衰减的前一次步伐 $v_{t−1}$。

这里，惯性就体现在对前一次步伐信息的重利用上。

类比中学物理知识，当前梯度就好比当前时刻受力产生的加速度，前一次步伐好比前一时刻的速度，当前步伐好比当前时刻的速度。

为了计算当前时刻的速度，应当考虑前一时刻速度和当前加速度共同作用的结果，因此 $v_t$ 直接依赖于 $v_{t−1}$ 和 $g_t$，而不仅仅是 $g_t$。另外，衰减系数 $\gamma$ 扮演了阻力的作用。<span style="color:red;">是呀，感觉这个太好了。</span>

中学物理还告诉我们，刻画惯性的物理量是动量，这也是算法名字的由来。沿山谷滚下的铁球，会受到沿坡道向下的力和与左右山壁碰撞的弹力。向下的力稳定不变，产生的动量不断累积，速度越来越快；左右的弹力总是在不停切换，动量累积的结果是相互抵消，自然减弱了球的来回震荡。

因此，与随机梯度下降法相比，动量方法的收敛速度更快，收敛曲线也更稳定，如图 7.5所示：

<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190407/432uPCkGNNJ9.png?imageslim">
</p>






# 相关

- [DeepLearning-500-questions](https://github.com/scutan90/DeepLearning-500-questions) 原文
