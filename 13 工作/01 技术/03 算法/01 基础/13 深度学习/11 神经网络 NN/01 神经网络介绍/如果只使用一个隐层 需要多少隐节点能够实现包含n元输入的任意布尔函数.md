

## 如果只使用一个隐层，需要多少隐节点能够实现包含 $n$ 元输入的任意布尔函数？

包含 $n$ 元输入的任意布尔函数可以唯一表示为析取范式（Disjunctive Normal Form，DNF）（由有限个简单合取式构成的析取式）的形式。<span style="color:red;">什么是析取范式来着？怎么唯一表示为析取范式的？</span>


先看一个 $n=5$ 的简单示例

$$
\begin{aligned} Y=& X_{1} X_{2} X_{3} X_{4} X_{5}+X_{1} X_{2} X_{3} X_{4} X_{3}+X_{1} X_{2} X_{3} X_{4} X_{5}+\\ & X_{1} \overline{X_{2} X_{3} X_{4}} X_{5}+X_{1} \overline{X_{2}} X_{3} X_{4} X_{5}+X_{2} X_{2} \overline{X_{3} X_{4}} X_{5} \end{aligned}\tag{9.2}
$$


在式（9.2）中，最终的输出 $Y$ 可以表示成由 $6$ 个合取范式所组成的析取范式。该函数可由包含 $6$ 个隐节点的 $3$ 层感知机实现，如图 9.2所示，用多层感知机实现由 6 个合取范式组成的析取范式：

<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190413/bn87qu8tJ6Re.png?imageslim">
</p>


首先证明单个隐结点可以表示任意合取范式。

考虑任意布尔变量假设 $X_{i}$ ：

- 若它在合取范式中出现的形式为正（ $X_{i}$ ），则设权重为 $1$
- 若出现的形式为非（ $\overline{X}_i $），则设权重为 $-1$
- 若没有在合取范式中出现。设权重为 $0$
- 并且偏置设为合取范式中变量的总数取负之后再加 $1$

可以看出，当采用 ReLU 激活函数之后，当且仅当所有出现的布尔变量均满足条件时，该隐藏单元才会被激活（输出 $1$），否则输出 $0$ ，这与合取范式的定义的相符的。然后，令所有隐藏单元到输出层的参数为 $1$，并设输出单元的偏置为 $0$ 。这样，当且仅当所有的隐藏单元都未被激活时，才会输出 $0$ ，否则都将输出一个正数，起到了析取的作用。<span style="color:red;">嗯，是的。</span>

我们可以使用卡诺图表示析取式，即用网格表示真值表，当输入的合取式值为 $1$ 时，则填充相应的网格。卡诺图中相邻的填色区域可以进行规约，以达到化简布尔函数的目的，如图 9.3所示，由图可见，有 W、X、Y、Z 共 4 个布尔变量，WX 的取值组合在纵轴显示，YZ 的取值组合在横轴显示。7个填色网格最终可规约为 3 个合取式，故该函数可由包含 3 个隐节点的 3 层感知机实现：<span style="color:red;">嗯，可规约为 3 个合取式，这个地方没看懂。怎么规约的？</span>

<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190413/6S9Uq5UjkIYl.png?imageslim">
</p>

回顾初始问题：在最差情况下，需要多少个隐藏结点来表示包含 $n$ 元输入的布尔函数呢？现在问题可以转化为：寻找 “最大不可规约的” $n$ 元析取范式，也等价于最大不可规约的卡诺图。<span style="color:red;">是的。</span>

直观上，我们只需间隔填充网格即可实现，其表示的布尔函数恰为 $n$ 元输入的异或操作，如图 9.4 所示。容易看出，在间隔填充的网格上反转任意网格的取值都会引起一次规约，因此， $n$ 元布尔函数的析取范式最多包含 $2^{(n-1)}$ 个不可规约的合取范式，对于单隐层的感知机，需要 $2^{(n-1)}$ 个隐节点实现：<span style="color:red;">嗯。有些厉害。再理解下。</span>

<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190413/3wl4FVMtauoA.png?imageslim">
</p>




## 考虑多隐层的情况，实现包含 $n$ 元输入的任意布尔函数最少需要多少个网络节点和网络层？

<span style="color:red;">是的呀，我也想知道。</span>

参考问题 1 的解答，考虑二元输入的情况，需要 3 个结点可以完成一次异或操作，其中隐藏层由两个节点构成，输出层需要一个结点，用来输出异或的结果并作为下一个结点的输入。对于四元输入，包含三次异或操作，需要 $3×3=9$ 个节点即可完成。

<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190413/8wBeF0kNBBYG.png?imageslim">
</p>

图 9.5 展示了一种可能的网络结构。输入 W、X、Y、Z 4 个布尔变量；首先用 3 个结点计算 $W \oplus X$ ；然后再加入 3 个节点，将 $W \oplus X$ 的输出与 $Y$ 进行异或，得到 $\mathrm{W} \oplus X \oplus \mathrm{Y}$ ；最后与 $Z$ 进行异或，整个网络总共需要 9 个结点。

<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190413/WCi98Jkm0xfG.png?imageslim">
</p>

而六元输入包含五次异或操作，因此需要 $3×5=15$ 个节点，网络的构造方式可参考图 9.6所示。依此类推，$n$ 元异或函数需要包括 $3(n-1)$ 个节点（包括最终输出节点）。可以发现，多隐层结构可以将隐节点的数目从指数级 $O\left(2^{(n-1)}\right)$ 直接减少至线性级 $O(3(n-1))$！<span style="color:red;">嗯，厉害。</span>


在上面所举的例子中，$n$ 元异或所需的 $O(3(n-1))$ 个结点可以对应 $2(n-1)$ 个网络层（包括隐含层和输出层），实际上，层数可以进一步减小。考虑到四元的输入 W、X、Y、Z；如果我们在同一层中计算 $W \oplus X$ 和 $Y \oplus Z$ ，再将二者的输出进行异或，就可以将层数从 6 降到 4。根据二分思想，每层节点两两分组进行异或运算，需要的最少网络层数为 $2\log _{2} N$（向上取整）。<span style="color:red;">是的是的。好。</span>



# 相关

- 《百面机器学习》

