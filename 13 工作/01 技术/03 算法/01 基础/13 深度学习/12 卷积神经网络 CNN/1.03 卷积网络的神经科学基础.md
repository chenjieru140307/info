
# 可以补充进来的

- 关于利用卷积神经网络作为视觉系统的模型是否有生物学理论支持，目前仍然存在许多质疑之声吗？


# 卷积网络的神经科学基础


卷积网络也许是生物学启发人工智能的最为成功的案例。

虽然卷积网络也经过许多其他领域的指导，但是神经网络的一些关键设计原则来自于神经科学。

卷积网络的历史始于神经科学实验，远早于相关计算模型的发展。为了确定关于哺乳动物视觉系统如何工作的许多最基本的事实，神经生理学家 David Hubel和 Torsten Wiesel合作多年。他们的成就最终获得了诺贝尔奖。他们的发现对当代深度学习模型有最大影响的是基于记录猫的单个神经元的活动。他们观察了猫的脑内神经元如何响应投影在猫前面屏幕上精确位置的图像。

生物发现：

- 处于视觉系统较为前面的神经元对非常特定的光模式（例如精确定向的条纹）反应最强烈，但对其他模式几乎完全没有反应。

区别：

- 人眼大部分是非常低的分辨率，除了一个被称为中央凹的小块。
  - 中央凹仅观察在手臂长度距离内一块拇指大小的区域。  虽然我们觉得我们可以看到高分辨率的整个场景，但这是由我们的大脑的潜意识部分创建的错觉，因为它缝合了我们瞥见的若干个小区域。
  - 大多数卷积网络实际上接收大的全分辨率的照片作为输入。  人类大脑控制几次眼动，称为扫视，以瞥见场景中最显眼的或任务相关的部分。  将类似的注意力机制融入深度学习模型是一个活跃的研究方向。  在深度学习的背景下，注意力机制对于自然语言处理是最成功的，参考 使用注意力机制并对齐数据片段。研究者已经研发了几种具有视觉机制的视觉模型，但到目前为止还没有成为主导方法。
  

+ 人类视觉系统集成了许多其他感觉，例如听觉，以及像我们的心情和想法一样的因素。  卷积网络迄今为止纯粹是视觉的。

+ 人类视觉系统不仅仅用于识别对象。  它能够理解整个场景，包括许多对象和对象之间的关系，以及处理我们的身体与世界交互所需的丰富的三维几何信息。  卷积网络已经应用于这些问题中的一些，但是这些应用还处于起步阶段。

+ 即使像 V1 这样简单的大脑区域也受到来自较高级别的反馈的严重影响。  反馈已经在神经网络模型中被广泛地探索，但还没有被证明提供了引人注目的改进。

+ 虽然前馈 IT 放电频率刻画了与卷积网络特征很多相同的信息，但是仍不清楚中间计算的相似程度。  大脑可能使用非常不同的激活和池化函数。  单个神经元的激活可能不能用单个线性过滤器的响应来很好地表征。  最近的 V1 模型涉及对每个神经元的多个二次过滤器。  事实上，我们的"简单细胞"和"复杂细胞"的草图图片可能并没有区别；简单细胞和复杂细胞可能是相同种类的细胞，但是它们的"参数"使得它们能够实现从我们所说的"简单"到"复杂"的连续的行为。



还值得一提的是，神经科学很少告诉我们该如何训练卷积网络。具有跨多个空间位置的参数共享的模型结构，可以追溯到早期关于视觉的联结主义模型，但是这些模型没有使用现代的反向传播算法和梯度下降。例如，结合了现代卷积网络的大多数模型结构设计元素，但依赖于层次化的无监督聚类算法。

{Lang+Hinton88}引入反向传播来训练时延神经网络。使用当代术语来说，TDNN是用于时间序列的一维卷积网络。用于这些模型的反向传播不受任何神经科学观察的启发，并且被一些人认为是生物不可信的。在基于使用反向传播训练的 TDNN 成功之后，{LeCun89d}通过将相同的训练算法应用于图像的 2 维卷积来发展现代卷积网络。

到目前为止，我们已经描述了简单细胞对于某些特征是如何呈现粗略的线性和选择性，复杂细胞是如何更加的非线性，并且对于这些简单细胞特征的某些变换具有不变性，以及在选择性和不变性之间交替放置的层可以产生对非常特定现象的祖母细胞。我们还没有精确描述这些单个细胞检测到了什么。在深度非线性网络中，可能难以理解单个细胞的功能。第一层中的简单细胞相对更容易分析，因为它们的响应由线性函数驱动。在人工神经网络中，我们可以直接显示卷积核的图像，来查看卷积层的相应通道是如何响应的。在生物神经网络中，我们不能访问权重本身。相反，我们在神经元自身中放置一个电极，在动物视网膜前显示几个白噪声图像样本，并记录这些样本中的每一个是如何导致神经元激活的。然后，我们可以对这些响应拟合线性模型，以获得近似的神经元权重。这种方法被称为反向相关。


反向相关向我们表明，大多数的 V1 细胞具有由 Gabor 函数所描述的权重。Gabor函数描述在图像中的 2 维点处的权重。我们可以认为图像是 2 维坐标 $I(x,y)$ 的函数。类似地，我们可以认为简单细胞是在图像中的一组位置采样，这组位置由一组 $x$ 坐标 $\mathbb X$ 和一组 $y$ 坐标 $\mathbb Y$ 来定义，并且使用的权重 $w(x,y)$ 也是位置的函数。<span style="color:red;">什么是 Gabor 函数</span>

从这个观点来看，简单细胞对于图像的响应由下式给出：

$$
  s(I)=\sum_{x\in \mathbb X} \sum_{y\in \mathbb Y} w(x, y)I(x,y).
$$

特别地，$w(x,y)$ 采用 Gabor 函数的形式：

$$
  w(x, y; \alpha, \beta_x, \beta_y, f, \phi, x_0, y_0, \tau) = \alpha \exp(-\beta_x x'^2 - \beta_y y'^2) \cos (fx' + \phi),
$$

其中

$$
  x' = (x-x_0)\cos(\tau) + (y-y_0)\sin(\tau)
$$

以及

$$
  y' = -(x-x_0) \sin(\tau) + (y-y_0)\cos(\tau).
$$


这里 $\alpha, \beta_x, \beta_y, f, \phi, x_0, y_0, \tau$ 都是控制~Gabor函数性质的参数。下图给出了 Gabor 函数在不同参数集上的一些例子。




<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190718/MGF6ggrEn9lW.png?imageslim">
</p>


> 9.18 具有各种参数设置的 Gabor 函数。白色表示绝对值大的正权重，黑色表示绝对值大的负权重，背景灰色对应于零权重。\emph{(左)}控制坐标系的参数具有不同值的 Gabor 函数，这些参数包括：$x_0$、$y_0$ 和 $\gamma$。在该网格中的每个 Gabor 函数被赋予和它在网格中的位置成比例的 $x_0$ 和 $y_0$ 的值，并且 $\tau$ 被选择为使得每个 Gabor 过滤器对从网格中心辐射出的方向非常敏感。对于其他两幅图，$x_0$、$y_0$ 和 $\gamma$ 固定为零。\emph{(中)}具有不同高斯比例参数 $\beta_x$ 和 $\beta_y$ 的 Gabor 函数。当我们从左到右通过网格时，Gabor函数被设置为增加宽度（减少 $\beta_x$）；当我们从上到下通过网格时，Gabor函数被设置为为增加高度（减少 $\beta_y$）。对于其他两幅图，$\beta$ 值固定为图像宽度的 1.5倍。\emph{(右)}具有不同的正弦参数 $f$ 和 $\phi$ 的 Gabor 函数。当我们从上到下移动时，$f$ 增加；当我们从左到右移动时，$\phi$ 增加。对于其他两幅图，$\phi$ 固定为 0，$f$ 固定为图像宽度的 5 倍。


参数 $x_0,y_0$ 和 $\tau$ 定义坐标系。我们平移和旋转 $x$ 和 $y$ 来得到 $x'$ 和 $y'$。具体地，简单细胞会响应以点 $(x_0, y_0)$ 为中心的图像特征，并且当我们沿着从水平方向旋转 $\tau$ 弧度的线移动时，简单细胞将响应亮度的变化。


作为 $x'$ 和 $y'$ 的函数，函数 $w$ 会响应当我们沿着 $x'$ 移动时的亮度变化。它有两个重要的因子：一个是高斯函数，另一个是余弦函数。

高斯因子 $\alpha \exp(-\beta_x x'^2 - \beta_y y'^2)$ 可以被视为阈值项，用于保证简单细胞仅对接近 $x'$ 和 $y'$ 都为零点处的值响应，换句话说，接近细胞接受域的中心。尺度因子 $\alpha$ 调整简单细胞响应的总的量级，而 $\beta_x$ 和 $\beta_y$ 控制接受域消退的速度。

余弦因子 $\cos (fx' + \phi)$ 控制简单细胞如何响应延 $x‘$ 轴的亮度改变。参数 $f$ 控制余弦的频率，$\phi$ 控制它的相位偏移。

合在一起，简单细胞的这个草图视图意味着，简单细胞对在特定位置处、特定方向上、特定空间频率的亮度进行响应。当图像中的光波与细胞的权重具有相同的相位时，简单细胞是最兴奋的。这种情况发生在当图像亮时，它的权重为正，而图像暗时，它的权重为负。当光波与权重完全异相时，简单细胞被抑制——当图像较暗时，它的权重为正；较亮时，它的权重为负。


复杂细胞的草图视图是它计算包含两个简单细胞响应的 2 维向量的 $L^2$ 范数：$c(I)=\sqrt{s_0(I)^2 + s_1(I)^2}$。一个重要的特殊情况是当 $s_1$ 和 $s_0$ 具有除 $\phi$ 以外都相同的参数，并且 $\phi$ 被设置为使得 $s_1$ 与 $s_0$ 相位相差四分之一周期时。在这种情况下，$s_0$ 和 $s_1$ 形成象限对。当高斯重新加权的图像 $I(x,y)\exp(-\beta_x x'^2 -\beta_y y^2)$ 包含具有频率 $f$、在方向 $\tau$ 上、接近 $(x_0, y_0)$ 的高振幅正弦波时，用先前方法定义的复杂细胞会响应，并且\emph{不管该波的相位偏移}。换句话说，复杂细胞对于图像在方向 $\tau$ 上的微小变换或者翻转图像（用白色代替黑色，反之亦然）具有不变性。

神经科学和机器学习之间最显著的对应关系，是从视觉上比较机器学习模型学得的特征与使用 V1 得到的特征。{Olshausen+Field-1996}说明，一个简单的无监督学习算法，稀疏编码，学习的特征具有与简单细胞类似的感受野。从那时起，我们发现，当应用于自然图像时，极其多样的统计学习算法学习类 Gabor 函数的特征。这包括大多数深度学习算法，它们在其第一层中学习这些特征。

下图给出了一些例子。因为如此众多不同的学习算法学习边缘检测器，所以很难仅基于学习算法学得的特征，来断定哪一个特定的学习算法是"正确"的大脑模型（虽然，当应用于自然图像时，如果一个算法不能学得某种检测器时，它能够作为一种否定标志）。这些特征是自然图像的统计结构的重要部分，并且可以通过许多不同的统计建模方法来重新获得。读者可以参考来获得自然图像统计领域的综述。




<p align="center">
    <img width="70%" height="70%" src="http://images.iterate.site/blog/image/20190718/dy8m3B0sEtSI.png?imageslim">
</p>

> 9.19 许多机器学习算法在应用于自然图像时，会学习那些用来检测边缘或边缘的特定颜色的特征。这些特征检测器使人联想到已知存在于初级视觉皮层中的 Gabor函数。(左) 通过应用于小图像块的无监督学习算法（尖峰和平板稀疏编码）学得的权重。(右)由完全监督的卷积 maxout 网络的第一层学得的卷积核。 相邻的一对过滤器驱动相同的 maxout单元。



# 相关

- 《深度学习》花书
